<!--月間統計グラフと総評画面-->
{% extends "base_diary.html" %}
{% load static %}
{% block title %}月間グラフ{% endblock %}

{% block header %}
<header>
    <div class="header__spacer--top"></div> <!-- 追加した要素 -->
    <h1>月間グラフ</h1>
    <div class="header__spacer"></div> <!-- 追加した要素 -->
</header>
{% endblock %}

{% block content %}
<main class="ground ground--blue"><!-- 追加した要素 -->
    <div class="scroll--content">
        <div class="calendar--background month-graph-page">
            <!-- タブ -->
            {% url 'diary:calendar_month' selected_date as calendar_month_url %}
            {% url 'diary:month_graph' selected_date as month_graph_url %}
            <div class="tab__button a--tab">
                <div class="a--tab--left {% if request.path == calendar_month_url %}active{% endif %}">
                    <a href="{{ calendar_month_url }}">月間カレンダー</a>
                </div>
                <div class="a--tab--right {% if request.path == month_graph_url %}active{% endif %}">
                    <a href="{{ month_graph_url }}">月間グラフ</a>
                </div>
            </div>

        <!-- 月間のページネーション -->
        <div class="col-md-6">
            <div class="text-right">
              <a href="{% url 'diary:month_graph' prev_month %}">
                <img src="{% static 'diary/assets/left_arrow.svg' %}">
              </a>
                <div calss="text-center">
                    <span id="year-month"></span>
                </div>
                <a href="{% url 'diary:month_graph' next_month %}">
                  <img src="{% static 'diary/assets/right_arrow.svg' %}">
                </a>
                <div class="return__button">
                    <button onclick="moveToNextMonth()"><img src="{% static 'diary/assets/return_arrow.svg' %}">今月</button>
                </div>
            </div>
        </div>

        <!-- グラフの表示 -->
            <div id="emotion__graph">
                <div class="emotion__graph__img">
                    <img src="{% static 'diary/assets/emotion_graph.svg' %}" alt="感情グラフ">感情グラフ</img>
                    {% comment %} 月間感情グラフ　棒グラフと折れ線グラフを表示 {% endcomment %}
                    <canvas id="barChart" width="400" height="200"></canvas><!-- 棒グラフ -->
                    <canvas id="lineChart" width="400" height="200"></canvas><!-- 折れ線グラフ -->
                </div>
            </div>


        <!-- ネココのカウンセリングコメント -->
        <div class="content__home__text--pink">
            <div class="content__today-diary__comment">
                <p>
                テストテストテストテストテストテストテスト
                </p>
            <!-- ネコココメントの画像 -->
                <div class="content__today-diary__comment__img">
                    <img src="{% static 'diary/assets/pink_iconneko.svg' %}" alt="カウンセラーネココの画像">
                </div>
            </div>
        </div>
    </div>
</main>



<script>
  var ctx = document.getElementById('lineChart').getContext('2d');
  var chartData = {{ data|safe }};
  
  var myChart = new Chart(ctx, {
      type: 'line',
      data: {
          labels: chartData.date,
          datasets: [
              {
                  label: 'Positive',
                  data: chartData.positive,
                  backgroundColor: 'rgba(75, 192, 192, 0.2)',
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1,
              },
              {
                  label: 'Negative',
                  data: chartData.negative,
                  backgroundColor: 'rgba(255, 99, 132, 0.2)',
                  borderColor: 'rgba(255, 99, 132, 1)',
                  borderWidth: 1,
              },
              {
                  label: 'Neutral',
                  data: chartData.neutral,
                  backgroundColor: 'rgba(255, 255, 0, 0.2)',
                  borderColor: 'rgba(255, 255, 0, 1)',
                  borderWidth: 1,
              },
              {
                  label: 'Mixed',
                  data: chartData.mixed,
                  backgroundColor: 'rgba(128, 128, 128, 0.2)',
                  borderColor: 'rgba(128, 128, 128, 1)',
                  borderWidth: 1,
              }
          ]
      },
      options: {
          scales: {
              y: {
                  beginAtZero: true
              }
          }
      }
  });
</script>
<script>
  var ctx = document.getElementById('barChart').getContext('2d');
  var chartData = {{ data|safe }};
  
  var myChart = new Chart(ctx, {
      type: 'horizontalBar',  // type を 'horizontalBar' に変更
      data: {
          labels: chartData.date,
          datasets: [
              {
                  label: 'Positive',
                  data: chartData.positive,
                  backgroundColor: 'rgba(75, 192, 192, 0.2)',
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
              },
              {
                  label: 'Negative',
                  data: chartData.negative,
                  backgroundColor: 'rgba(255, 99, 132, 0.2)',
                  borderColor: 'rgba(255, 99, 132, 1)',
                  borderWidth: 1
              },
              {
                  label: 'Neutral',
                  data: chartData.neutral,
                  backgroundColor: 'rgba(255, 255, 0, 0.2)',
                  borderColor: 'rgba(255, 255, 0, 1)',
                  borderWidth: 1
              },
              {
                  label: 'Mixed',
                  data: chartData.mixed,
                  backgroundColor: 'rgba(128, 128, 128, 0.2)',
                  borderColor: 'rgba(128, 128, 128, 1)',
                  borderWidth: 1
              }
          ]
      },
      options: {
            { stacked: "100%" }

      }
  });
</script>


{% endblock %}
