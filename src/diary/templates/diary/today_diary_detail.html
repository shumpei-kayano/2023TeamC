<!-- 日記詳細画面 ネココポジティブコメント画面（ホーム） -->
{% extends "base_diary.html" %}

{% load static%}

{% block title %}日記詳細{% endblock %}

{% block header %}
<header>
    <div class="header__spacer--top"></div>
    <h1 class="date">--/--(-)</h1>
    <div class="header__weather">
        <img class="weatherImg">
        <span class="tempMax">-℃</span>
    </div>
</header>
{% endblock %}

{% block content %}
<!-- タブ -->
{% url 'diary:today_diary_detail' as today_diary_detail_url %}
{% url 'diary:today_diary_graph' as today_diary_graph_url %}
<div class="tab__button a--tab">
    <div class="a--tab--left {% if request.path == today_diary_detail_url %}active{% endif %}">
        <a href="{{ today_diary_detail_url }}">日記詳細画面</a>
    </div>
    <div class="a--tab--right {% if request.path == today_diary_graph_url %}active{% endif %}">
        <a href="{{ today_diary_graph_url }}">グラフ</a>
    </div>
</div>

<!-- 編集削除ボタン -->
<div class="content__diary-diary__group">
    <div class="a--blue">
        <div class="icon__button__delete">
            {% if diary %}
            <ul>
                        <br>作成日時：{{diary.created_date}}</br><br>
                        <br>日記内容：{{ diary.content }}</br><br>
                        {% if diary.photo1 %}
                            <img src="{{ diary.photo1.url }}" alt="Diary Photo1">
                        {% endif %}
                        {% if diary.photo2 %}
                            <img src="{{ todya.photo2.url }}" alt="Diary Photo2">
                        {% endif %}
                        {% if diary.photo3 %}
                            <img src="{{ diary.photo3.url }}" alt="Diary Photo3">
                        {% endif %}
                        {% if diary.photo4 %}
                            <img src="{{ todya.photo4.url }}" alt="Diary Photo4">
                        {% endif %}
                    </div>
            </ul>
        {% else %}
            <p>今日の日記はありません。</p>
        {% endif %}
            <a href="{% url  'diary:diary_delete' diary.id %}">
                <img src="{% static 'diary/assets/delete.png' %}" >削除</a>
        </div>
        <div class="icon__button__edit">
            <a href="{% url  'diary:diary_update' diary.id %}">
                <img src="{% static 'diary/assets/edit.png' %}">編集</a>
        </div>

    <!-- ユーザーが保存した日記の表示 -->
    <div class="content__diary-diary__text">
        <p>
            {% comment %} {{ ユーザーが入力した日記を表示させてください }} {% endcomment %}
        </p>
    </div>

    <!-- ユーザーが保存した画像の表示 -->
    {% comment %} {% if 画像があれば %}
        <div class="content__diary-diary__images">
            {% for 画像を表示させてください %}
                <div class="content__diary-diary__img">
                    <a href="#" data-image-id="{{ 画像のid }}">
                    <img src="{{ ユーザーが保存した画像を表示させてください }}" alt="日記の画像">
                    </a>
                </div>
            {% endfor %}
        </div>
    {% endif %} {% endcomment %}
</div><!-- content__diary-diary__group -->

<!-- ネコココメント -->
<div class="content__diary-diary__comment">
    <p>
        {{ diary.ai_comment }}
    </p>
</div>
<!-- ネココの画像 -->
<div class="content__diary-diary__comment__img">
    <img src="{% static 'diary/assets/neko_comment.png' %}" alt="ネココの画像">
</div>

<!-- 画像のポップアップ -->
<div class="modal fade" id="image-modal" tabindex="-1" role="dialog" aria-labelledby="image-modal-label" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-body">
                <img src="" id="image-modal-image" class="img-fluid" alt="">
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">閉じる</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
{% comment %} css
.modal-footer {
    text-align: center;
  } {% endcomment %}
{% comment %} {% block js%}
<script>
    // 画像をクリックしたときに画像ポップアップを開く
    $(".content__diary-diary__images a").on("click", function(e) {
    // 画像ポップアップのコンテンツを取得
    let image = $(this).data("image-id");
    let imageUrl = $("#diary-{{ diary.id }}-image-{{ image }}").attr("src");

    // 画像ポップアップを開く
    $("#image-modal-image").attr("src", imageUrl);
    $("#image-modal").modal("show");

    // イベントをキャンセル
    e.preventDefault();
    });
</script>
{% endblock %} {% endcomment %}
{% comment %} <script src="{% static 'js/image-preview.js' %}">

    function openImage(image) {
        // 画像の元の比率で表示する
        let imageWidth = image.width;
        let imageHeight = image.height;
        let windowWidth = window.innerWidth;
        let windowHeight = window.innerHeight;
        let maxWidth = windowWidth - 100;
        let maxHeight = windowHeight - 100;
        let ratio = imageWidth / imageHeight;
        let width = Math.min(maxWidth, imageWidth);
        let height = width / ratio;
        if (height > maxHeight) {
            height = maxHeight;
          width = height * ratio;
        }
    
        // 画像ポップアップを表示する
        let imagePreview = document.getElementById("image-preview");
        imagePreview.style.width = width + "px";
        imagePreview.style.height = height + "px";
        imagePreview.style.display = "block";
    
        // 画像をポップアップに表示する
        let imageElement = document.getElementById("image");
        imageElement.src = image.src;
    
        // 閉じるボタンを追加する
        let closeButton = document.createElement("button");
        closeButton.textContent = "閉じる";
        closeButton.onclick = closeImage;
        closeButton.className = "close-button";
        imagePreview.appendChild(closeButton);
        }
    
      // 画像ポップアップを閉じる
        function closeImage() {
        let imagePreview = document.getElementById("image-preview");
        imagePreview.style.display = "none";
    
        // 画像をポップアップから削除する
        let imageElement = document.getElementById("image");
        imageElement.src = "";
        }
    
    </script> {% endcomment %}