<!--会員情報編集画面-->

{% extends "base_diary.html" %}

{% load static %}

{% block title %}会員情報変更{% endblock %}

{% block css %}
<!-- ページ固有のCSSを読み込み -->
<link rel="stylesheet" href="{% static 'diary/css/setting_page.css' %}">
{% endblock %}

{% block header %}
<header>
    <div class="header__button">
        <div class="header__back__img">
            {% comment %} member_information_edit_cancel.htmlに遷移させてください {% endcomment %}
            <a href="{% url 'diary:member_information_edit_cancel' %}"><img src="{% static 'diary/assets/back_arrow.svg' %}">戻る</a>
        </div>
    </div>
    <h1>会員情報変更</h1>
    <div class="header__spacer"></div> <!-- 追加した要素 -->
</header>
{% endblock %}

{% block content %}
<main class="ground ground--white">
    <div class="user-infomation--center">

 
        <form method="POST" action="{% url 'diary:member_information_edit_check' %}">
            {% csrf_token %}
            
            <!-- エラーメッセージを一括表示 -->
            {% for field in form %}
            <div class="form-field">
                {{ field.errors }}
            </div>
            {% endfor %}
            <!-- 各フィールドのラベル、入力欄、エラーメッセージを表示 -->
            {% for field in form %}
            {% if field.name != 'password' %}  {# パスワード以外のフィールドを表示 #}
                <div class="form-field">
                    <label for="{{ field.id_for_label }}">{{ field.label }}</label>
                    {{ field }}
                </div>
            {% endif %}
        {% endfor %}

        <div class="btn--blue--info">
            <button type="submit">確認する</button>
        </div>
        </form>
        
        <div class="user-infomation__image">
            <img src="{% static 'diary/assets/neko_dango.svg' %}">
        </div>

    </div>
</main>
{% endblock %}
{% comment %} {% block script %}
<script>
    const form = document.querySelector('form');

    form.addEventListener('submit', function (e) {
        // エラーチェックロジックをここに追加
        const passwordInput = document.querySelector('input[name="password"]');
        const emailInput = document.querySelector('input[name="email"]');
        
        const passwordError = document.querySelector('#password-error');
        const emailError = document.querySelector('#email-error');
        
        passwordError.textContent = '';  // エラーメッセージをクリア
        emailError.textContent = '';  // エラーメッセージをクリア

        // パスワードが8文字未満か半角英数字でない場合のエラーチェック
        if (passwordInput.value.length < 8 || !/^[0-9a-zA-Z]+$/.test(passwordInput.value)) {
            e.preventDefault(); // 送信を中止
            passwordError.textContent = "パスワードは8文字以上の半角英数字で設定してください";
        }

        // メールアドレスの書式が正しくない場合のエラーチェック
        if (!emailInput.value.match(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)) {
            e.preventDefault(); // 送信を中止
            emailError.textContent = "正しいメールアドレスを入力してください";
        }
    });
</script>

{% endblock %} {% endcomment %}