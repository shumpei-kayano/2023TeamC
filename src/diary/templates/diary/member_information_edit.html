<!--会員情報編集画面-->

{% extends "base_diary.html" %}

{% load static %}

{% block title %}会員情報変更{% endblock %}

{% block header %}
<header>
    <div class="header__button">
        <div class="header__back__img">
            {% comment %} member_information_edit_cancel.htmlに遷移させてください {% endcomment %}
            <a href="">
                <svg width="9" height="16" viewBox="0 0 9 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M0.292893 8.70711C-0.097631 8.31658 -0.097631 7.68342 0.292893 7.29289L6.65685 0.928932C7.04738 0.538408 7.68054 0.538408 8.07107 0.928932C8.46159 1.31946 8.46159 1.95262 8.07107 2.34315L2.41421 8L8.07107 13.6569C8.46159 14.0474 8.46159 14.6805 8.07107 15.0711C7.68054 15.4616 7.04738 15.4616 6.65685 15.0711L0.292893 8.70711ZM2 9L1 9L1 7L2 7L2 9Z" fill="white"/>
                </svg>
                戻る</a>
        </div>
    </div>
    <h1>会員情報変更</h1>
    <div class="header__spacer"></div> <!-- 追加した要素 -->
</header>
{% endblock %}

{% block content %}
<main class="ground ground--white">
    <div class="scroll--content">

        <form method="POST" action="{% url 'diary:member_information_edit_check' %}" ><!--次のページに遷移させてください-->
            {% csrf_token %}
            <!-- ユーザーネームの編集 -->
            <div class="user-infomation">
                <div class="content__user-name__text">
                    <label for="username">ユーザーネーム</label>
                    <br><input type="text" id="username" name="username" value="{{ user.username }}">
                </div>

                <!-- メールアドレスの編集 -->
                <div class="content__user-email__text">
                    <label for="email">メールアドレス</label>
                    <br><input type="email" id="email" name="email" value="{{ user.email }}">
                    <!--エラー-->
                    <div class="error-message" id="email-error"></div>
                </div>
            </div>


    {% comment %} 検討中
            <!-- パスワードの編集 -->
            <div class="content__user-password__text">
                <label for="password">パスワード</label>
                <br><input type="password" id="password" name="password">
                <!--エラー-->
                <div class="error-message" id="password-error"></div>
            </div> {% endcomment %}

            <!-- 送信ボタン -->
        <div class="btn--blue">
            <button type="submit">確認する</button>
        </div>
        </form>

        <div class="neko__dango.image">
            <img class="neko-dango" img src="{% static 'diary/assets/neko_dango.svg' %}">
        </div>


        {% comment %} パスワードが8文字以上の半角英数字でない場合とメールアドレスの書式が正しくない場合は
    テキストボックスの下にエラーメッセージを表示{% endcomment %}

    </div>
</main>
{% endblock %}

{% block script %}
<script>
    const form = document.querySelector('form');

    form.addEventListener('submit', function (e) {
        // エラーチェックロジックをここに追加
        const passwordInput = document.querySelector('input[name="password"]');
        const emailInput = document.querySelector('input[name="email"]');
        
        const passwordError = document.querySelector('#password-error');
        const emailError = document.querySelector('#email-error');
        
        passwordError.textContent = '';  // エラーメッセージをクリア
        emailError.textContent = '';  // エラーメッセージをクリア

        // パスワードが8文字未満か半角英数字でない場合のエラーチェック
        if (passwordInput.value.length < 8 || !/^[0-9a-zA-Z]+$/.test(passwordInput.value)) {
            e.preventDefault(); // 送信を中止
            passwordError.textContent = "パスワードは8文字以上の半角英数字で設定してください";
        }

        // メールアドレスの書式が正しくない場合のエラーチェック
        if (!emailInput.value.match(/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/)) {
            e.preventDefault(); // 送信を中止
            emailError.textContent = "正しいメールアドレスを入力してください";
        }
    });
</script>

{% endblock %}