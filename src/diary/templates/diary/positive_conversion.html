<!-- ポジティブ変換画面とカウンセリング催促ポップアップ -->
{% extends "base.html" %}

{% load static%}

{% block title %}日記のポジティブ変換{% endblock %}

{% block header %}
<header>
    <div class="header__nowdate">
        {{ 現在の日付と曜日を次の書式で表示させてください→0000/00/00(月) }}
    <div class="header__nowdate">
        <div class="header__weaher">
            <div class="header__weaher__img">
                <img src="{% static "assets/{{ 天気のアイコンを表示させてください（晴れsunny.png、曇りcloud.png、雨rain.png） }}" %}}" alt="天気の画像">
            </div>
            {{ 気温を次の書式で表示させてください→00℃ }}
        </div>
</header>
{% endblock %}

<!-- <style>
    /* ポップアップの初期状態は非表示 */
    .popup {
        display: none;
        position: fixed;
        bottom: 0;
        left: 0;
        width: 100%;
        background-color: #fff;
        padding: 20px;
        box-shadow: 0px -5px 5px rgba(0, 0, 0, 0.2);
        z-index: 1;
    }
</style>
</head> -->

{% block content %}
<!-- ユーザーが入力した日記の表示 -->
<div class="content__today-diary__text">
    <p>
        {{ ユーザーが入力した日記を表示させてください }}
    </p>
</div>

<!-- ネコ画像 -->
<div class="content__today-diary__positive-img">
    <img src="{% static "assets/positive_neko.png" %}}" alt="ポジティブな猫の画像">
</div>

<!-- ポジティブ変換した日記の表示 -->
    <!-- enctype='multipart/form-data'でファイルアップロード -->
<form method="post" enctype='multipart/form-data'>
    {% csrf_token %}
    <div class="content__today-diary__positive-text">
        <p>
            {{ ポジティブ変換した日記を表示させてください }}
        </p>
    </div>
    <p>日記の内容を上記に変更しますか？</p>
    <div class="button">
        <button type="submit">保存</button>
    </div>
</form>

<div class="cancel__button">
    <button id="back-button" type="button">キャンセル</button>
</div>

<!-- ポップアップ要素
<div class="popup" id="popup">
    <p>特定の条件に合致しました。メッセージを表示します。</p>
</div> -->

<!-- ポップアップ要素 -->
{% if 特定の条件でカウンセリング催促ポップアップを表示させる %}
<div class="popup">
    <div class="popup__text">
        <p>ネガティブが続いているにゃ。<br>ネココのカウンセリングを受けるにゃ。</p>
    </div>
    <div class="popup__img">
        <img src="{% static "assets/counseling_request.png" %}}" alt="カウンセリングを薦める猫の画像">
    </div>
    <div class="button">
        <button type="button">ネココのアドバイスを受ける</button>
    </div>
    <div class="gray__button">
        <a href="{% url 'counseling' %}"><img src="{% static "assets/close.png" %}}" alt="アイコン">キャンセル</a>
    </div>
</div>
{% endif %}

{% endblock %}

{% block js %}
<script>
    // キャンセルボタンを押したときの処理
    document.getElementById("back-button").addEventListener("click", function() {
        history.back();
    });

    // カウンセリング催促ポップアップの表示
    $(function(){
        $('.popup').fadeIn();
    });

    $(document).ready(function() {
        // ポップアップを下からスライドして表示
        $('.popup').slideDown();

        // キャンセルボタンをクリックした時の処理
        $('.cancel-button').click(function() {
            $('.popup').slideUp();
        });
    });

    {% comment %} document.getElementById("text-form").addEventListener("submit", function (e) {
        e.preventDefault();
        
        var userText = document.getElementById("user-text").value;
        
        // 特定の条件が満たされた場合にポップアップを表示
        if (userText.includes("特定のワード")) {
            // ポップアップを表示
            document.getElementById("popup").style.display = "block";
        } else {
            // 特定の条件に該当しない場合はフォームを通常の方法で送信
            this.submit();
        }
    }); {% endcomment %}
</script>
{% endblock %}

<html>
<head>
  <title>Django Pop-up Example</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
</head>
<body>
  <div class="container">
    <h1>Django Pop-up Example</h1>
    <button id="save-button">Save</button>

    <div class="popup" id="first-popup">
      <div class="popup-header">
        <h2>Save confirmation</h2>
        <button class="close-button" onclick="closePopup('first-popup')">×</button>
      </div>
      <div class="popup-body">
        Are you sure you want to save?
      </div>
    </div>

    <div class="popup" id="second-popup">
      <div class="popup-header">
        <h2>Cancel confirmation</h2>
        <button class="close-button" onclick="closePopup('second-popup')">×</button>
      </div>
      <div class="popup-body">
        Are you sure you want to cancel?
      </div>
    </div>
  </div>

  <script>
    function closePopup(id) {
      document.getElementById(id).classList.remove("show");
    }

    // 保存ボタンをクリックしたときに最初のポップアップを表示する
    document.getElementById("save-button").addEventListener("click", function() {
      document.getElementById("first-popup").classList.add("show");
    });

    // 最初のポップアップのキャンセルボタンをクリックしたときに2番目のポップアップを表示する
    document.getElementById("first-popup").querySelector(".close-button").addEventListener("click", function() {
      document.getElementById("second-popup").classList.add("show");
    });

    // 2番目のポップアップのキャンセルボタンをクリックしたときにポップアップを閉じる
    document.getElementById("second-popup").querySelector(".close-button").addEventListener("click", function() {
      document.getElementById("first-popup").classList.remove("show");
      document.getElementById("second-popup").classList.remove("show");
    });
  </script>
</body>
</html>
